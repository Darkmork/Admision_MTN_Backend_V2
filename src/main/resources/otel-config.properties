# OpenTelemetry Configuration for MTN Admission System
# Chilean timezone and PII-safe trace collection

# Service identification
otel.service.name=mtn-admission-backend
otel.service.version=1.0.0
otel.resource.attributes=service.namespace=mtn,deployment.environment=production,service.instance.id=${HOSTNAME:unknown}

# Trace configuration
otel.traces.exporter=jaeger
otel.exporter.jaeger.endpoint=http://jaeger:14250
otel.exporter.jaeger.timeout=10s

# Metrics configuration  
otel.metrics.exporter=prometheus
otel.exporter.prometheus.port=9464
otel.exporter.prometheus.host=0.0.0.0

# Logs configuration
otel.logs.exporter=otlp
otel.exporter.otlp.logs.endpoint=http://loki:3100/otlp/v1/logs
otel.exporter.otlp.logs.headers=X-Tenant-ID=mtn-admission

# Sampling configuration - 10% for production, 100% for traces > 2s
otel.traces.sampler=traceidratio
otel.traces.sampler.arg=0.1

# Correlation ID propagation
otel.propagators=tracecontext,baggage,b3,jaeger,ottrace,xray

# Instrumentation configuration
otel.instrumentation.spring-webmvc.enabled=true
otel.instrumentation.spring-webflux.enabled=true
otel.instrumentation.jdbc.enabled=true
otel.instrumentation.jms.enabled=true
otel.instrumentation.rabbitmq.enabled=true
otel.instrumentation.http-client.enabled=true
otel.instrumentation.logback.enabled=true

# PII masking configuration
otel.instrumentation.http.capture-headers.client.request=x-correlation-id,x-trace-id,user-agent
otel.instrumentation.http.capture-headers.client.response=x-correlation-id,x-trace-id
otel.instrumentation.http.capture-headers.server.request=x-correlation-id,x-trace-id,user-agent
otel.instrumentation.http.capture-headers.server.response=x-correlation-id,x-trace-id

# Disable sensitive data capture
otel.instrumentation.jdbc.statement-sanitizer.enabled=true
otel.instrumentation.spring-data.repository-operation-name.enabled=true
otel.instrumentation.http.capture-request-parameters=false

# Chilean timezone for span timestamps
otel.resource.attributes.timezone=America/Santiago

# JVM metrics
otel.java.global-autoconfigure.enabled=true
otel.javaagent.extensions.enabled=true